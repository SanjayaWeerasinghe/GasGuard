# ğŸ—ï¸ GasGuard Complete System Architecture

## ğŸ“Š End-to-End Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PHYSICAL LAYER (IoT Sensors)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     ğŸ”´ MQ-4           ğŸ”´ MQ-6           ğŸ”´ MQ-7          ğŸ”´ MQ-136
   (Methane)          (LPG)         (CO Monitor)        (H2S)
       â”‚                 â”‚                 â”‚                 â”‚
       â”‚ Analog         â”‚ Analog          â”‚ Analog          â”‚ Analog
       â”‚ 0-5V           â”‚ 0-5V            â”‚ 0-5V            â”‚ 0-5V
       â”‚                 â”‚                 â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ADC (Analog to Digital)     â”‚
              â”‚   (Arduino/Raspberry Pi)      â”‚
              â”‚   10-bit: 0-1023              â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ Digital Values
                              â”‚ [512, 340, 128, 45]
                              â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EDGE PROCESSING (Raspberry Pi / ESP32)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Sensor Value Preprocessing   â”‚
              â”‚                               â”‚
              â”‚  1. Read ADC values           â”‚
              â”‚  2. Calculate Rs/R0 ratio     â”‚
              â”‚  3. Apply sensor equations:   â”‚
              â”‚                               â”‚
              â”‚  CH4:  1012*(Rs/R0)^-2.786   â”‚
              â”‚  LPG:  574*(Rs/R0)^-2.331    â”‚
              â”‚  CO:   955*(Rs/R0)^-3.105    â”‚
              â”‚  H2S:  42.5*(Rs/R0)^-2.894   â”‚
              â”‚                               â”‚
              â”‚  4. Convert to PPM values     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ PPM Values
                              â”‚ [CH4: 1500, LPG: 800, CO: 45, H2S: 12]
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Format JSON Payload         â”‚
              â”‚                               â”‚
              â”‚   {                           â”‚
              â”‚     "clientID": "ZONE_A_01",  â”‚
              â”‚     "timestamp": "2026-02-04",â”‚
              â”‚     "gasTypes": ["CH4","LPG", â”‚
              â”‚                  "CO","H2S"], â”‚
              â”‚     "values": [1500,800,45,12]â”‚
              â”‚   }                           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ HTTP POST / MQTT
                              â”‚ WiFi/Ethernet
                              â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND SERVER (Node.js + Express)                         â”‚
â”‚                              Port: 3001                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   API Endpoint Receiver       â”‚
              â”‚   POST /api/readings          â”‚
              â”‚                               â”‚
              â”‚   âœ… Validate JSON schema     â”‚
              â”‚   âœ… Check client ID          â”‚
              â”‚   âœ… Timestamp injection      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                                      â”‚
                              â–¼                                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Save Raw Reading            â”‚    â”‚   Forward to ML Service    â”‚
              â”‚   to MongoDB                  â”‚    â”‚   HTTP POST                â”‚
              â”‚                               â”‚    â”‚   http://localhost:5000    â”‚
              â”‚   Collection: "readings"      â”‚    â”‚   /predict                 â”‚
              â”‚   {                           â”‚    â”‚                            â”‚
              â”‚     clientID: "ZONE_A_01",    â”‚    â”‚   Payload:                 â”‚
              â”‚     gasReadings: {            â”‚    â”‚   {                        â”‚
              â”‚       methane: 1500,          â”‚    â”‚     values: [1500,800,     â”‚
              â”‚       lpg: 800,               â”‚    â”‚              45, 12]       â”‚
              â”‚       carbonMonoxide: 45,     â”‚    â”‚   }                        â”‚
              â”‚       hydrogenSulfide: 12     â”‚    â”‚                            â”‚
              â”‚     },                        â”‚    â”‚                            â”‚
              â”‚     timestamp: ISODate(...)   â”‚    â”‚                            â”‚
              â”‚   }                           â”‚    â”‚                            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â–¼
                              â”‚
                              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              â”‚   ML SERVICE (Python + Flask)       â”‚
                              â”‚              â”‚   Port: 5000                        â”‚
                              â”‚              â”‚   TensorFlow + LSTM Model           â”‚
                              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â–¼
                              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              â”‚  STEP 1: Data Preprocessing         â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  1. Receive: [1500, 800, 45, 12]   â”‚
                              â”‚              â”‚  2. Map to features:                â”‚
                              â”‚              â”‚     {                               â”‚
                              â”‚              â”‚       methane: 1500,                â”‚
                              â”‚              â”‚       lpg: 800,                     â”‚
                              â”‚              â”‚       carbonMonoxide: 45,           â”‚
                              â”‚              â”‚       hydrogenSulfide: 12           â”‚
                              â”‚              â”‚     }                               â”‚
                              â”‚              â”‚  3. Normalize with scaler:          â”‚
                              â”‚              â”‚     scaled = scaler.transform(data) â”‚
                              â”‚              â”‚     â†’ [0.15, 0.08, 0.045, 0.012]   â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â–¼
                              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              â”‚  STEP 2: LSTM Model Prediction      â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                              â”‚              â”‚  â”‚  Input: 10 timesteps Ã— 4     â”‚  â”‚
                              â”‚              â”‚  â”‚  [t-9 to t-0]                â”‚  â”‚
                              â”‚              â”‚  â”‚                              â”‚  â”‚
                              â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  LSTM Layer 1          â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  64 units, Dropout 30% â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
                              â”‚              â”‚  â”‚           â†“                  â”‚  â”‚
                              â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  LSTM Layer 2          â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  32 units, Dropout 30% â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
                              â”‚              â”‚  â”‚           â†“                  â”‚  â”‚
                              â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  Dense Output Layer    â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â”‚  4 outputs (next step) â”‚ â”‚  â”‚
                              â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
                              â”‚              â”‚  â”‚                              â”‚  â”‚
                              â”‚              â”‚  â”‚  Predicted: [1480,795,44,11] â”‚  â”‚
                              â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  Calculate Prediction Error:        â”‚
                              â”‚              â”‚  error = |actual - predicted|       â”‚
                              â”‚              â”‚  error = [20, 5, 1, 1] â†’ avg: 6.75  â”‚
                              â”‚              â”‚  normalized_error = 0.267           â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â–¼
                              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              â”‚  STEP 3: Hybrid Classification      â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  PATH A: PPM-Based Classification   â”‚
                              â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                              â”‚              â”‚  â”‚ For each gas, check thresholdsâ”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ CH4 (1500 ppm):               â”‚ â”‚
                              â”‚              â”‚  â”‚   1000-2500 â†’ LOW_ANOMALY âœ“   â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ LPG (800 ppm):                â”‚ â”‚
                              â”‚              â”‚  â”‚   500-1000 â†’ LOW_ANOMALY âœ“    â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ CO (45 ppm):                  â”‚ â”‚
                              â”‚              â”‚  â”‚   35-50 â†’ UNUSUAL âœ“           â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ H2S (12 ppm):                 â”‚ â”‚
                              â”‚              â”‚  â”‚   10-15 â†’ UNUSUAL âœ“           â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ PPM Risk: UNUSUAL (max)       â”‚ â”‚
                              â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  PATH B: LSTM Anomaly Detection     â”‚
                              â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                              â”‚              â”‚  â”‚ Prediction error: 0.267       â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ Check thresholds:             â”‚ â”‚
                              â”‚              â”‚  â”‚   0.15 â‰¤ 0.267 < 0.30         â”‚ â”‚
                              â”‚              â”‚  â”‚   â†’ LOW_ANOMALY âœ“             â”‚ â”‚
                              â”‚              â”‚  â”‚                               â”‚ â”‚
                              â”‚              â”‚  â”‚ Anomaly Risk: LOW_ANOMALY     â”‚ â”‚
                              â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  FUSION RULE: max(PPM, Anomaly)     â”‚
                              â”‚              â”‚  Final: max(UNUSUAL, LOW_ANOMALY)   â”‚
                              â”‚              â”‚  â†’ UNUSUAL                          â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â–¼
                              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              â”‚  STEP 4: Return Classification      â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â”‚  {                                  â”‚
                              â”‚              â”‚    "riskState": "UNUSUAL",          â”‚
                              â”‚              â”‚    "confidence": "high",            â”‚
                              â”‚              â”‚    "ppmRisk": "UNUSUAL",            â”‚
                              â”‚              â”‚    "anomalyRisk": "LOW_ANOMALY",    â”‚
                              â”‚              â”‚    "predictionError": 0.267,        â”‚
                              â”‚              â”‚    "dominantGas": "carbonMonoxide", â”‚
                              â”‚              â”‚    "classificationMethod": "hybrid",â”‚
                              â”‚              â”‚    "gasDetails": {                  â”‚
                              â”‚              â”‚      "CH4": {"ppm": 1500,           â”‚
                              â”‚              â”‚               "risk": "LOW_ANOMALY"},â”‚
                              â”‚              â”‚      "LPG": {"ppm": 800,            â”‚
                              â”‚              â”‚               "risk": "LOW_ANOMALY"},â”‚
                              â”‚              â”‚      "CO":  {"ppm": 45,             â”‚
                              â”‚              â”‚               "risk": "UNUSUAL"},   â”‚
                              â”‚              â”‚      "H2S": {"ppm": 12,             â”‚
                              â”‚              â”‚               "risk": "UNUSUAL"}    â”‚
                              â”‚              â”‚    }                                â”‚
                              â”‚              â”‚  }                                  â”‚
                              â”‚              â”‚                                     â”‚
                              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                      â”‚
                              â”‚                                      â”‚
                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚     ML Result
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Backend Decision Engine      â”‚
              â”‚                               â”‚
              â”‚  Risk State: UNUSUAL          â”‚
              â”‚                               â”‚
              â”‚  Decision Rules:              â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚  â”‚ NORMAL      â†’ None      â”‚  â”‚
              â”‚  â”‚ LOW_ANOMALY â†’ Alert     â”‚  â”‚
              â”‚  â”‚ UNUSUAL     â†’ Alert     â”‚  â”‚ â—„â”€â”€â”€ YOU ARE HERE
              â”‚  â”‚ ALERT       â†’ Alert     â”‚  â”‚
              â”‚  â”‚ WARNING     â†’ Alert +   â”‚  â”‚
              â”‚  â”‚               Ventilationâ”‚  â”‚
              â”‚  â”‚               + Blockchainâ”‚  â”‚
              â”‚  â”‚ CRITICAL    â†’ Alert +   â”‚  â”‚
              â”‚  â”‚               Ventilationâ”‚  â”‚
              â”‚  â”‚               FORCED +   â”‚  â”‚
              â”‚  â”‚               Blockchainâ”‚  â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
              â”‚                               â”‚
              â”‚  Action: Create Alert         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                 â”‚                 â”‚                  â”‚
            â–¼                 â–¼                 â–¼                  â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MongoDB Database  â”‚  â”‚   WebSocket  â”‚  â”‚  Blockchain â”‚  â”‚  Ventilation     â”‚
â”‚                    â”‚  â”‚   Broadcast  â”‚  â”‚  Logging    â”‚  â”‚  Control         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                â”‚                   â”‚
         â–¼                     â–¼                â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                   â”‚
â”‚ Collection: alerts â”‚  â”‚  Dashboard   â”‚       â”‚                   â”‚
â”‚                    â”‚  â”‚  & Frontend  â”‚       â”‚                   â”‚
â”‚ {                  â”‚  â”‚              â”‚       â”‚                   â”‚
â”‚   clientID: ...,   â”‚  â”‚  Real-time   â”‚       â”‚                   â”‚
â”‚   severity: "med", â”‚  â”‚  Updates     â”‚       â”‚                   â”‚
â”‚   riskState:       â”‚  â”‚              â”‚       â”‚  (Only for        â”‚
â”‚     "UNUSUAL",     â”‚  â”‚  ğŸ”´ UNUSUAL  â”‚       â”‚   WARNING &       â”‚
â”‚   message: "CO:    â”‚  â”‚  Risk Alert  â”‚       â”‚   CRITICAL)       â”‚
â”‚     45 ppm",       â”‚  â”‚              â”‚       â”‚                   â”‚
â”‚   metadata: {      â”‚  â”‚  CO: 45 ppm  â”‚       â”‚                   â”‚
â”‚     dominantGas:   â”‚  â”‚  âš ï¸  Action  â”‚       â–¼                   â–¼
â”‚       "CO",        â”‚  â”‚  Required    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ppmRisk: ...,  â”‚  â”‚              â”‚  â”‚ Smart       â”‚  â”‚  Relay Control   â”‚
â”‚     anomalyRisk:..â”‚  â”‚  ğŸ”” Alert    â”‚  â”‚ Contract    â”‚  â”‚                  â”‚
â”‚   },               â”‚  â”‚  Triggered   â”‚  â”‚             â”‚  â”‚  GPIO Pin:       â”‚
â”‚   timestamp: ...,  â”‚  â”‚              â”‚  â”‚ function    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   acknowledged:    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ logEvent()  â”‚  â”‚  â”‚   OFF      â”‚  â”‚
â”‚     false          â”‚                    â”‚ {           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ }                  â”‚                    â”‚   timestamp â”‚  â”‚                  â”‚
â”‚                    â”‚                    â”‚   clientID  â”‚  â”‚  (Triggered only â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   riskState â”‚  â”‚  for WARNING/    â”‚
         â”‚                                â”‚   hash      â”‚  â”‚  CRITICAL)       â”‚
         â–¼                                â”‚ }           â”‚  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Collection:        â”‚                    â”‚ Returns:    â”‚
â”‚   readings         â”‚                    â”‚ 0x1234...   â”‚
â”‚                    â”‚                    â”‚ (tx hash)   â”‚
â”‚ {                  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   clientID: ...,   â”‚
â”‚   gasReadings: {   â”‚
â”‚     methane: 1500, â”‚
â”‚     lpg: 800,      â”‚
â”‚     co: 45,        â”‚
â”‚     h2s: 12        â”‚
â”‚   },               â”‚
â”‚   mlPrediction: {  â”‚
â”‚     riskState:     â”‚
â”‚       "UNUSUAL",   â”‚
â”‚     confidence:    â”‚
â”‚       "high",      â”‚
â”‚     ppmRisk: ...,  â”‚
â”‚     anomalyRisk:..â”‚
â”‚   },               â”‚
â”‚   timestamp: ...   â”‚
â”‚ }                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          NOTIFICATION LAYER                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  Dashboard   â”‚
                              â”‚  Receives    â”‚
                              â”‚  WebSocket   â”‚
                              â”‚  Update      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚                â”‚
                    â–¼                â–¼                â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Visual      â”‚  â”‚  Audio       â”‚  â”‚  SMS/Email   â”‚
            â”‚  Indicators  â”‚  â”‚  Alarm       â”‚  â”‚  (Optional)  â”‚
            â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
            â”‚  âš ï¸  Orange  â”‚  â”‚  ğŸ”Š Beep     â”‚  â”‚  ğŸ“§ Alert    â”‚
            â”‚  Status LED  â”‚  â”‚  Pattern     â”‚  â”‚  Sent        â”‚
            â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
            â”‚  "UNUSUAL"   â”‚  â”‚  2 beeps/sec â”‚  â”‚  "CO: 45 ppm"â”‚
            â”‚  Risk Level  â”‚  â”‚              â”‚  â”‚              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## ğŸ”„ Decision Matrix

### **Risk State â†’ Action Mapping**

| Risk State   | PPM Range       | LSTM Error | Alert | Ventilation | Blockchain | Alarm Pattern |
|--------------|-----------------|------------|-------|-------------|------------|---------------|
| **NORMAL**   | All safe        | < 0.15     | âŒ    | âŒ          | âŒ         | Silent        |
| **LOW_ANOMALY** | 1 gas slight  | 0.15-0.30  | âœ…    | âŒ          | âŒ         | 1 beep/5s     |
| **UNUSUAL**  | 1-2 gas moderate| 0.30-0.50  | âœ…    | âŒ          | âŒ         | 2 beeps/sec   |
| **ALERT**    | 1 gas high      | 0.50-0.75  | âœ…    | âŒ          | âŒ         | 1 beep/sec    |
| **WARNING**  | Near dangerous  | 0.75-1.10  | âœ…    | âœ… AUTO     | âœ…         | Continuous    |
| **CRITICAL** | Life threatening| > 1.10     | âœ…    | âœ… FORCED   | âœ…         | Siren         |

---

## ğŸ“Š Data Flow Summary

```
IoT Sensors (MQ-4, MQ-6, MQ-7, MQ-136)
    â†“ Analog voltage (0-5V)
Edge Device (Arduino/Raspberry Pi)
    â†“ ADC conversion â†’ Digital values (0-1023)
Preprocessing (Sensor equations)
    â†“ PPM calculations â†’ [1500, 800, 45, 12]
Backend API (Node.js)
    â†“ JSON payload â†’ Store raw data
ML Service (Python/TensorFlow)
    â†“ Normalize â†’ LSTM prediction â†’ Error calculation
Hybrid Classification
    â†“ PPM thresholds + LSTM anomaly â†’ Max fusion
Decision Engine
    â”œâ”€â†’ MongoDB (Store reading + classification)
    â”œâ”€â†’ WebSocket (Real-time dashboard update)
    â”œâ”€â†’ Blockchain (WARNING/CRITICAL only)
    â””â”€â†’ Ventilation (WARNING/CRITICAL only)
Notification Layer
    â””â”€â†’ Dashboard + Alarms + Alerts
```

---

## ğŸ¯ Technology Stack per Layer

### **IoT Layer:**
- **Hardware:** MQ-4, MQ-6, MQ-7, MQ-136 sensors
- **Controller:** Arduino Uno / Raspberry Pi 4
- **ADC:** 10-bit (Arduino) / 12-bit (RPi)
- **Communication:** WiFi (ESP8266) / Ethernet

### **Edge Processing:**
- **Language:** C++ (Arduino) / Python (RPi)
- **Libraries:** Wire.h, SPI.h, WiFi.h
- **Conversion:** Analog â†’ PPM (sensor-specific equations)

### **Backend Server:**
- **Runtime:** Node.js 14+
- **Framework:** Express.js 4.x
- **Real-time:** Socket.IO (WebSocket)
- **Database Driver:** Mongoose (MongoDB)

### **ML Service:**
- **Language:** Python 3.8+
- **Framework:** Flask
- **ML Library:** TensorFlow 2.x, Keras
- **Preprocessing:** NumPy, scikit-learn (MinMaxScaler)
- **Model:** 2-layer LSTM (64+32 units)

### **Database:**
- **Primary:** MongoDB (NoSQL)
- **Collections:** readings, alerts, clients
- **Indexing:** clientID, timestamp
- **Cloud:** MongoDB Atlas (optional)

### **Blockchain:**
- **Network:** Ethereum-compatible (Ganache/Testnet)
- **Library:** Web3.js
- **Smart Contract:** Solidity
- **Events:** LogGasEvent, LogAlert

### **Frontend:**
- **Framework:** React 18
- **UI Library:** Material-UI / Tailwind
- **Real-time:** Socket.IO client
- **Visualization:** Chart.js / Recharts

---

## âš¡ Performance Specifications

| Component | Latency | Throughput |
|-----------|---------|------------|
| **IoT Sampling** | 1 Hz (1 reading/sec) | Continuous |
| **Edge Processing** | < 50ms | Real-time |
| **Network Transfer** | < 100ms | WiFi/Ethernet |
| **Backend API** | < 50ms | 100 req/sec |
| **ML Prediction** | < 100ms | 50 predictions/sec |
| **Database Write** | < 50ms | 200 writes/sec |
| **Blockchain Write** | 1-5 sec | Async (non-blocking) |
| **WebSocket Broadcast** | < 10ms | All connected clients |
| **End-to-End** | < 500ms | Real-time monitoring |

---

## ğŸ” Security Considerations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Security Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IoT â†’ Backend:                              â”‚
â”‚   âœ… HTTPS/TLS encryption                   â”‚
â”‚   âœ… Client authentication (API keys)       â”‚
â”‚   âœ… Rate limiting (prevent DoS)            â”‚
â”‚                                             â”‚
â”‚ Backend â†’ ML Service:                       â”‚
â”‚   âœ… Internal network only                  â”‚
â”‚   âœ… Input validation (schema check)        â”‚
â”‚                                             â”‚
â”‚ Database:                                   â”‚
â”‚   âœ… Authentication required                â”‚
â”‚   âœ… Encrypted at rest                      â”‚
â”‚   âœ… IP whitelist (MongoDB Atlas)           â”‚
â”‚                                             â”‚
â”‚ Blockchain:                                 â”‚
â”‚   âœ… Immutable audit trail                  â”‚
â”‚   âœ… Hash verification                      â”‚
â”‚   âœ… Timestamp proof                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scalability

### **Horizontal Scaling:**
```
Multiple IoT Clients â†’ Load Balancer â†’ Multiple Backend Instances
                                      â†’ Single ML Service (GPU-accelerated)
                                      â†’ MongoDB Replica Set
                                      â†’ Blockchain Network
```

### **Supported Load:**
- **IoT Clients:** Up to 1000 concurrent
- **Readings/sec:** Up to 10,000
- **Users (Dashboard):** Up to 500 concurrent
- **Data Retention:** Unlimited (MongoDB)
- **Blockchain:** Permanent audit trail

---

## ğŸ“ Academic Justification

This architecture demonstrates:

1. âœ… **IoT Integration** - Real sensor data acquisition
2. âœ… **Edge Computing** - Preprocessing at source
3. âœ… **Machine Learning** - LSTM for pattern recognition
4. âœ… **Hybrid Intelligence** - Domain knowledge + ML
5. âœ… **Blockchain** - Immutable audit logging
6. âœ… **Real-time Systems** - Sub-500ms response
7. âœ… **Distributed Architecture** - Microservices pattern
8. âœ… **Industrial Safety** - OSHA compliance
9. âœ… **Scalability** - Production-ready design
10. âœ… **Automation** - Intelligent response system

---

**This diagram shows the complete end-to-end flow from physical sensors to automated safety response! ğŸš€**
